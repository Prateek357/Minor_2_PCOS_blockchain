{% extends "analysis_base.html" %}

{% block content %}
<div class="container">
    <h1>Analysis Results for {{ filename }}</h1>
    <hr />

    <div class="section">
        <h2>Summary Statistics</h2>
        {{ analysis.summary_html | safe }}
    </div>

    <div class="section">
        <h2>Kolmogorov-Smirnov Test Results</h2>
        {{ analysis.ks_html | safe }}
    </div>

    <div class="section">
        <h2>Plots</h2>
        {% for plot_path in analysis.plot_paths %}
            {# Remove the 'app/static/' prefix from plot_path to get relative path for url_for #}
            {% set rel_path = plot_path.replace('app/static/', '') %}
            <img src="{{ url_for('static', filename=rel_path) }}" alt="Plot" class="plot-img" />
        {% endfor %}
    </div>

    <div class="section">
        <h2>Interpretation</h2>
        {{ analysis.interpretation | safe }}
    </div>

    <div class="section">
        <h2>Synthetic Dataset</h2>
        {% if synthetic_data_html %}
            <button id="toggleDatasetBtn" class="btn btn-info mb-3">Show Synthetic Dataset</button>
            <div id="syntheticDataset" style="display: none;">
                {{ synthetic_data_html | safe }}
            </div>
            <script>
                const btn = document.getElementById('toggleDatasetBtn');
                const datasetDiv = document.getElementById('syntheticDataset');
                btn.addEventListener('click', () => {
                    if (datasetDiv.style.display === 'none') {
                        datasetDiv.style.display = 'block';
                        btn.textContent = 'Hide Synthetic Dataset';
                    } else {
                        datasetDiv.style.display = 'none';
                        btn.textContent = 'Show Synthetic Dataset';
                    }
                });
            </script>
        {% else %}
            <p>No synthetic dataset available.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
